<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vecterm Playground</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="top-bar">
    <!-- Left: Mode and Context -->
    <div id="top-bar-left">
      <div id="mode-display">
        <span class="mode-label">MODE:</span>
        <span id="mode-value" class="mode-idle">IDLE</span>
      </div>
      <div id="context-display">
        <span class="context-label">CONTEXT:</span>
        <span id="context-value">vecterm</span>
      </div>
    </div>

    <!-- Center: Context-aware HUD -->
    <div id="hud-display">
      <span class="hud-label">FPS:</span> <span id="fps-counter">60</span>
      <span class="hud-separator">|</span>
      <span class="hud-label">ENTITIES:</span> <span id="entity-counter">0</span>
      <span class="hud-separator">|</span>
      <span class="hud-label">CANVAS:</span> <span id="active-canvas">MAIN</span>
      <span class="hud-separator">|</span>
      <span class="hud-label">STATE:</span> <span id="state-size">0KB</span>
    </div>

    <!-- Right: Quick Actions -->
    <div id="top-bar-right">
      <button id="toggle-grid" class="top-bar-btn" title="Toggle Grid">
        <span class="btn-icon">▢</span>
      </button>
      <button id="toggle-settings" class="top-bar-btn" title="Settings">
        <span class="btn-icon">⚙</span>
      </button>
      <button id="toggle-auth" class="top-bar-btn">Toggle Login</button>
    </div>
  </div>

  <canvas id="main-canvas" width="1920" height="1080"></canvas>

  <!-- Right Sidebar -->
  <aside id="right-sidebar">
    <div class="sidebar-header">
      <span class="sidebar-title">[ VECTERM MONITOR ]</span>
      <button id="sidebar-toggle" class="sidebar-toggle-btn">◀</button>
    </div>

    <div class="sidebar-section">
      <h3 class="section-title" data-section="transitions">State Flow</h3>
      <div class="section-content" id="transitions-content">
        <div class="flow-diagram">
          <div class="flow-step" id="step-action">
            <div class="step-number">1</div>
            <div class="step-content">
              <strong>Action Dispatched</strong>
              <p>User triggers an action</p>
            </div>
          </div>
          <div class="flow-arrow">↓</div>
          <div class="flow-step" id="step-reducer">
            <div class="step-number">2</div>
            <div class="step-content">
              <strong>Reducer Processes</strong>
              <p>Pure function updates state</p>
            </div>
          </div>
          <div class="flow-arrow">↓</div>
          <div class="flow-step" id="step-store">
            <div class="step-number">3</div>
            <div class="step-content">
              <strong>Store Updated</strong>
              <p>New state is saved</p>
            </div>
          </div>
          <div class="flow-arrow">↓</div>
          <div class="flow-step" id="step-render">
            <div class="step-number">4</div>
            <div class="step-content">
              <strong>UI Re-renders</strong>
              <p>Components update with new state</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-section">
      <h3 class="section-title" data-section="state">Current State</h3>
      <div class="section-content" id="state-content">
        <pre id="state-display"></pre>
      </div>
    </div>

    <div class="sidebar-section">
      <h3 class="section-title" data-section="history">Action History</h3>
      <div class="section-content" id="history-content">
        <div id="action-history"></div>
      </div>
    </div>

    <div class="sidebar-section">
      <h3 class="section-title" data-section="config">Config</h3>
      <div class="section-content" id="config-content">
        <div class="control-group">
          <label for="delay">Animation Delay:</label>
          <input type="range" id="delay" min="0" max="3000" value="1000" step="100">
          <span id="delay-value">1000ms</span>
        </div>

        <div class="control-group">
          <label>State Management:</label>
          <div class="config-buttons">
            <button id="save-config" class="config-btn">Save Config</button>
            <button id="load-config" class="config-btn">Load Config</button>
            <button id="clear-config" class="config-btn">Clear Config</button>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-section">
      <h3 class="section-title" data-section="theme">Theme</h3>
      <div class="section-content" id="theme-content">

        <!-- Z-Index Scale -->
        <div class="token-group">
          <h4 class="token-title collapsible" data-subsection="zindex">Z-Index Scale ▼</h4>
          <div class="subsection-content" id="subsection-zindex">
            <div class="token-list">
              <div class="token-item">
                <span class="token-name">--z-base</span>
                <span class="token-value">0</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-content</span>
                <span class="token-value">10</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-sidebar</span>
                <span class="token-value">50</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-fab</span>
                <span class="token-value">60</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-topbar</span>
                <span class="token-value">100</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-modal</span>
                <span class="token-value">500</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-tooltip</span>
                <span class="token-value">800</span>
              </div>
              <div class="token-item">
                <span class="token-name">--z-critical</span>
                <span class="token-value">9999</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Spacing Scale -->
        <div class="token-group">
          <h4 class="token-title collapsible" data-subsection="spacing">Spacing Scale ▼</h4>
          <div class="subsection-content" id="subsection-spacing">
            <div class="token-list">
              <div class="token-item">
                <span class="token-name">--space-xs</span>
                <span class="token-value">4px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--space-sm</span>
                <span class="token-value">8px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--space-md</span>
                <span class="token-value">16px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--space-lg</span>
                <span class="token-value">24px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--space-xl</span>
                <span class="token-value">32px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--space-xxl</span>
                <span class="token-value">48px</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Color Palette (Collapsible) -->
        <div class="token-group">
          <h4 class="token-title collapsible" data-subsection="colors">Color Palette ▼</h4>
          <div class="subsection-content" id="subsection-colors">

            <div class="palette-section">
              <div class="palette-label">Base Colors</div>
              <div class="color-grid">
                <div class="color-swatch" style="background: var(--color-base-1);" title="--color-base-1: #4fc3f7"></div>
                <div class="color-swatch" style="background: var(--color-base-2);" title="--color-base-2: #81d4fa"></div>
                <div class="color-swatch" style="background: var(--color-base-3);" title="--color-base-3: #29b6f6"></div>
                <div class="color-swatch" style="background: var(--color-base-4);" title="--color-base-4: #00ff88"></div>
                <div class="color-swatch" style="background: var(--color-base-5);" title="--color-base-5: #ff4444"></div>
                <div class="color-swatch" style="background: var(--color-base-6);" title="--color-base-6: #ffa726"></div>
                <div class="color-swatch" style="background: var(--color-base-7);" title="--color-base-7: #ab47bc"></div>
                <div class="color-swatch" style="background: var(--color-base-8);" title="--color-base-8: #ffeb3b"></div>
              </div>
            </div>

            <div class="palette-section">
              <div class="palette-label">Contrast Colors</div>
              <div class="color-grid">
                <div class="color-swatch" style="background: var(--color-contrast-1);" title="--color-contrast-1: #b03c08"></div>
                <div class="color-swatch" style="background: var(--color-contrast-2);" title="--color-contrast-2: #7e2b05"></div>
                <div class="color-swatch" style="background: var(--color-contrast-3);" title="--color-contrast-3: #d64909"></div>
                <div class="color-swatch" style="background: var(--color-contrast-4);" title="--color-contrast-4: #ff0077"></div>
                <div class="color-swatch" style="background: var(--color-contrast-5);" title="--color-contrast-5: #00bbbb"></div>
                <div class="color-swatch" style="background: var(--color-contrast-6);" title="--color-contrast-6: #0058d9"></div>
                <div class="color-swatch" style="background: var(--color-contrast-7);" title="--color-contrast-7: #54b843"></div>
                <div class="color-swatch" style="background: var(--color-contrast-8);" title="--color-contrast-8: #0014c4"></div>
              </div>
            </div>

            <div class="palette-section">
              <div class="palette-label">Triadic Colors</div>
              <div class="color-grid">
                <div class="color-swatch" style="background: var(--color-triad-1);" title="--color-triad-1: #f74fc3"></div>
                <div class="color-swatch" style="background: var(--color-triad-2);" title="--color-triad-2: #fa81d4"></div>
                <div class="color-swatch" style="background: var(--color-triad-3);" title="--color-triad-3: #f629b6"></div>
                <div class="color-swatch" style="background: var(--color-triad-4);" title="--color-triad-4: #88ff00"></div>
                <div class="color-swatch" style="background: var(--color-triad-5);" title="--color-triad-5: #ff4488"></div>
                <div class="color-swatch" style="background: var(--color-triad-6);" title="--color-triad-6: #26a7ff"></div>
                <div class="color-swatch" style="background: var(--color-triad-7);" title="--color-triad-7: #bc47ab"></div>
                <div class="color-swatch" style="background: var(--color-triad-8);" title="--color-triad-8: #eb3bff"></div>
              </div>
            </div>

          </div>
        </div>

        <!-- Typography -->
        <div class="token-group">
          <h4 class="token-title collapsible" data-subsection="typography">Typography ▼</h4>
          <div class="subsection-content" id="subsection-typography">
            <div class="token-list">
              <div class="token-item">
                <span class="token-name">--font-primary</span>
                <span class="token-value">System</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-secondary</span>
                <span class="token-value">Helvetica</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-code</span>
                <span class="token-value">Monaco</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-size-xs</span>
                <span class="token-value">9px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-size-sm</span>
                <span class="token-value">11px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-size-md</span>
                <span class="token-value">13px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-size-lg</span>
                <span class="token-value">14px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-size-xl</span>
                <span class="token-value">16px</span>
              </div>
              <div class="token-item">
                <span class="token-name">--font-size-xxl</span>
                <span class="token-value">24px</span>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </aside>

  <!-- Settings Panel (initially hidden) -->
  <div id="settings-panel" class="hidden">
    <div class="panel-header">
      <span class="panel-title">[ QUICK SETTINGS ]</span>
      <button id="settings-close" class="minimize-btn">×</button>
    </div>
    <div class="settings-content">
      <!-- Grid Settings -->
      <div class="settings-section">
        <h4 class="settings-title">Grid System</h4>
        <div class="settings-group">
          <label for="grid-type-select">Grid Type:</label>
          <select id="grid-type-select" class="settings-select">
            <option value="none">None</option>
            <option value="square">Square Grid</option>
            <option value="character">Character Grid (80×24)</option>
          </select>
        </div>
        <div class="settings-group">
          <label>
            <input type="checkbox" id="grid-visible-checkbox">
            Show Grid Overlay
          </label>
        </div>
        <div class="settings-group">
          <label>
            <input type="checkbox" id="grid-snap-checkbox">
            Snap to Grid
          </label>
        </div>
      </div>

      <!-- Rendering Settings -->
      <div class="settings-section">
        <h4 class="settings-title">VT100 Effects</h4>
        <div class="settings-group">
          <label for="glow-intensity">Phosphor Glow:</label>
          <input type="range" id="glow-intensity" min="0" max="1" step="0.1" value="0.3">
          <span id="glow-value">0.3</span>
        </div>
        <div class="settings-group">
          <label for="scanline-intensity">Scanlines:</label>
          <input type="range" id="scanline-intensity" min="0" max="1" step="0.05" value="0.15">
          <span id="scanline-value">0.15</span>
        </div>
        <div class="settings-group">
          <label>
            <input type="checkbox" id="backface-culling-checkbox" checked>
            Back-face Culling
          </label>
        </div>
        <div class="settings-group">
          <label>
            <input type="checkbox" id="hidden-line-checkbox" checked>
            Hidden Line Removal
          </label>
        </div>
      </div>

      <!-- Camera Settings (for 3D mode) -->
      <div class="settings-section" id="camera-settings">
        <h4 class="settings-title">Camera (3D)</h4>
        <div class="settings-group">
          <label for="camera-fov">Field of View:</label>
          <input type="range" id="camera-fov" min="30" max="120" step="5" value="60">
          <span id="fov-value">60°</span>
        </div>
        <div class="settings-group">
          <button id="camera-reset-btn" class="settings-btn">Reset Camera</button>
        </div>
      </div>

      <!-- Gamepad Settings -->
      <div class="settings-section" id="gamepad-settings">
        <h4 class="settings-title">Gamepad Input</h4>
        <div class="settings-group">
          <div id="gamepad-status" class="gamepad-status disconnected">
            No gamepad connected
          </div>
        </div>
        <div class="settings-group">
          <label>
            <input type="checkbox" id="gamepad-enabled-checkbox" checked>
            Enable Gamepad Input
          </label>
        </div>
        <div class="settings-group">
          <label for="gamepad-preset-select">Controller Type:</label>
          <select id="gamepad-preset-select" class="settings-select">
            <option value="xbox">Xbox Controller</option>
            <option value="playstation">PlayStation Controller</option>
            <option value="generic">Generic Controller</option>
          </select>
        </div>
        <div class="settings-group">
          <small class="settings-help">
            Gamepad controls camera in 3D mode and entities in game mode.
            Use CLI command 'gamepad.status' for details.
          </small>
        </div>
      </div>
    </div>
  </div>

  <!-- VT100 Terminal Display -->
  <div id="cli-panel" class="hidden">
    <!-- VECTERM TERMINAL brand - top left -->
    <div class="vt100-brand">VECTERM TERMINAL</div>
    <!-- Hamburger menu - top right INSIDE boundary -->
    <button id="vt100-menu-toggle" class="vt100-hamburger" title="VT100 Controls">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <!-- Terminal output scrollable area -->
    <div id="cli-output"></div>
    <!-- Absolute positioned input at bottom -->
    <div class="vt100-input">
      <span class="vt100-prompt" id="cli-prompt">vecterm&gt;</span>
      <input type="text" id="cli-input" placeholder="">
    </div>
    <!-- VT100 Parameter Controls - HUD centered INSIDE terminal -->
    <div id="vt100-params" class="hidden">
      <div class="param-row">
        <label>SCAN</label>
        <input type="range" id="param-scanline" min="0" max="30" value="15" step="1">
        <span class="param-val">0.15</span>
      </div>
      <div class="param-row">
        <label>GLOW</label>
        <input type="range" id="param-glow" min="0" max="100" value="40" step="5">
        <span class="param-val">0.40</span>
      </div>
      <div class="param-row">
        <label>WAVE</label>
        <input type="range" id="param-wave" min="0" max="10" value="2" step="1">
        <span class="param-val">2px</span>
      </div>
    </div>
  </div>

  <!-- Terminal FAB -->
  <button id="cli-fab" class="fab" title="Toggle CLI">
    <svg class="fab-icon" viewBox="0 0 60 50" xmlns="http://www.w3.org/2000/svg">
      <!-- VT100 Terminal Body -->
      <rect x="5" y="5" width="50" height="35" fill="none" stroke="currentColor" stroke-width="2" rx="2"/>
      <!-- Screen -->
      <rect x="9" y="9" width="42" height="22" fill="none" stroke="currentColor" stroke-width="1.5"/>
      <!-- Screen scanlines hint -->
      <line x1="9" y1="14" x2="51" y2="14" stroke="currentColor" stroke-width="0.5" opacity="0.6"/>
      <line x1="9" y1="19" x2="51" y2="19" stroke="currentColor" stroke-width="0.5" opacity="0.6"/>
      <line x1="9" y1="24" x2="51" y2="24" stroke="currentColor" stroke-width="0.5" opacity="0.6"/>
      <!-- Keyboard suggestion -->
      <line x1="8" y1="34" x2="52" y2="34" stroke="currentColor" stroke-width="1.5"/>
      <line x1="12" y1="37" x2="48" y2="37" stroke="currentColor" stroke-width="1"/>
      <!-- Base -->
      <path d="M 20 40 L 15 45 L 45 45 L 40 40 Z" fill="none" stroke="currentColor" stroke-width="1.5"/>
    </svg>
  </button>

  <div id="footer">
    <div class="footer-section">
      <span class="footer-label">VECTERM PLAYGROUND</span>
      <span class="footer-value">v1.0.0</span>
    </div>
    <div class="footer-section">
      <span class="footer-label">RENDER ENGINE</span>
      <span class="footer-value" id="footer-engine">Canvas 2D/3D</span>
    </div>
    <div class="footer-section">
      <span class="footer-label">STATUS</span>
      <span class="footer-value status-active" id="footer-status">OPERATIONAL</span>
    </div>
    <div class="footer-section">
      <span class="footer-label">UPTIME</span>
      <span class="footer-value" id="uptime">00:00:00</span>
    </div>
  </div>

  <!-- Non-module dependencies (to be refactored later) -->
  <script src="VectermMath.js"></script>
  <script src="vecterm/grid-utils.js"></script>
  <script src="Vecterm.js"></script>
  <script src="VectermCanvas.js"></script>
  <script src="InputSystem.js"></script>
  <script src="ReduxCanvas.js"></script>
  <script src="Quadrapong.js"></script>

  <!-- Main application as ES6 module -->
  <script type="module" src="app.js"></script>
  <!-- <script  src="gamepad-iife.js"></script> -->
</body>
</html>

